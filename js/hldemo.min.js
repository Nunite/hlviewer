var HLDemo=function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CONSTS=t.DemoWriter=t.DemoReader=void 0;var n=r(1),o=a(n),i=r(4),f=a(i),s=r(3),l=a(s);t.DemoReader=o.default,t.DemoWriter=f.default,t.CONSTS=l.default},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){t.demoInfo={timestamp:e.readFloat32(),refParams:{vieworg:e.readFloat32Array(3),viewangles:e.readFloat32Array(3),forward:e.readFloat32Array(3),right:e.readFloat32Array(3),up:e.readFloat32Array(3),frametime:e.readFloat32(),time:e.readFloat32(),intermission:e.readInt32(),paused:e.readInt32(),spectator:e.readInt32(),onground:e.readInt32(),waterlevel:e.readInt32(),simvel:e.readFloat32Array(3),simorg:e.readFloat32Array(3),viewheight:e.readFloat32Array(3),idealpitch:e.readFloat32(),cl_viewangles:e.readFloat32Array(3),health:e.readInt32(),crosshairangle:e.readFloat32Array(3),viewsize:e.readFloat32(),punchangle:e.readFloat32Array(3),maxclients:e.readInt32(),viewentity:e.readInt32(),playernum:e.readInt32(),max_entities:e.readInt32(),demoplayback:e.readInt32(),hardware:e.readInt32(),smoothing:e.readInt32(),ptr_cmd:e.readInt32(),ptr_movelets:e.readInt32(),viewport:e.readInt32Array(4),nextView:e.readInt32(),onlyClientDraw:e.readInt32()},userCmd:{lerp_msec:e.readInt16(),msec:e.readUint8(),align_1:e.readInt8(),viewangles:e.readFloat32Array(3),forwardmove:e.readFloat32(),sidemove:e.readFloat32(),upmove:e.readFloat32(),lightlevel:e.readInt8(),align_2:e.readInt8(),buttons:e.readUint16(),impulse:e.readInt8(),weaponselect:e.readInt8(),align_3:e.readInt8(),align_4:e.readInt8(),impact_index:e.readInt32(),impact_position:e.readFloat32Array(3)},moveVars:{gravity:e.readFloat32(),stopspeed:e.readFloat32(),maxspeed:e.readFloat32(),spectatormaxspeed:e.readFloat32(),accelerate:e.readFloat32(),airaccelerate:e.readFloat32(),wateraccelerate:e.readFloat32(),friction:e.readFloat32(),edgefriction:e.readFloat32(),waterfriction:e.readFloat32(),entgravity:e.readFloat32(),bounce:e.readFloat32(),stepsize:e.readFloat32(),maxvelocity:e.readFloat32(),zmax:e.readFloat32(),waveHeight:e.readFloat32(),footsteps:e.readInt32(),skyName:e.readString(w.default.FRAME_SKYNAME_SIZE),rollangle:e.readFloat32(),rollspeed:e.readFloat32(),skycolor_r:e.readFloat32(),skycolor_g:e.readFloat32(),skycolor_b:e.readFloat32(),skyvec_x:e.readFloat32(),skyvec_y:e.readFloat32(),skyvec_z:e.readFloat32()},view:e.readFloat32Array(3),viewmodel:e.readInt32()},t.incoming_sequence=e.readInt32(),t.incoming_acknowledged=e.readInt32(),t.incoming_reliable_acknowledged=e.readInt32(),t.incoming_reliable_sequence=e.readInt32(),t.outgoing_sequence=e.readInt32(),t.reliable_sequence=e.readInt32(),t.last_reliable_sequence=e.readInt32();var r=e.readInt32();return t.msg=e.readUint8Array(r),!0}function i(e){if("HLDEMO"!==e.readString(6))throw new c("incorrect file signature");return e.skip(2),{demoProtocol:e.readInt32(),netProtocol:e.readInt32(),mapName:e.readString(w.default.HEADER_MAPNAME_SIZE),gameDirectory:e.readString(w.default.HEADER_GAMEDIRECTORY_SIZE),mapCRC:e.readInt32(),directoryOffset:e.readInt32()}}function f(e,t){if(t<0||e.view.buffer.byteLength-4<t)throw new c("invalid directory offset");e.seekBeg(t);var r=e.readInt32();if(r<w.default.DIRECTORY_ENTRY_COUNT_MIN||r>w.default.DIRECTORY_ENTRY_COUNT_MAX)throw new c("invalid number of directory entries");for(var a=[],n=0;n<r;++n)a.push({type:e.readInt32(),description:e.readString(w.default.DIRECTORY_ENTRY_DESCRIPTION_SIZE),flags:e.readInt32(),CDtrack:e.readInt32(),trackTime:e.readFloat32(),frameCount:e.readInt32(),offset:e.readInt32(),fileLength:e.readInt32()});return a}function s(e){var t={type:e.readUint8(),time:e.readFloat32(),frame:e.readInt32()},r=void 0;return r=w.default.FRAME_TYPE_MIN<=t.type&&t.type<=w.default.FRAME_TYPE_MAX?!v[t.type](e,t):!o(e,t),{frame:t,stop:r}}function l(e,t,r){if(5!==t.demoProtocol)throw new c("only demo protocol 5 is supported");for(var a=0;a<r.length;++a){var n=r[a];if(n.offset<0||e.view.buffer.byteLength<n.offset)throw new c("invalid offset in directory entry");e.seekBeg(n.offset),n.frames=[];var o=void 0;do o=s(e),n.frames.push(o.frame);while(!o.stop)}}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),u=r(2),m=a(u),I=r(3),w=a(I),c=function e(t){n(this,e),this.message=t},v=[function(){return!1},function(){return!1},function(){return!0},function(e,t){return t.command=e.readString(w.default.FRAME_CONSOLE_COMMAND_SIZE),!0},function(e,t){return t.origin=e.readFloat32Array(3),t.viewangles=e.readFloat32Array(3),t.weaponBits=e.readInt32(),t.fov=e.readFloat32(),!0},function(){return!1},function(e,t){return t.flags=e.readInt32(),t.index=e.readInt32(),t.delay=e.readFloat32(),t.eventArgs={flags:e.readInt32(),entityIndex:e.readInt32(),origin:e.readFloat32Array(3),angles:e.readFloat32Array(3),velocity:e.readFloat32Array(3),ducking:e.readInt32(),fparam1:e.readFloat32(),fparam2:e.readFloat32(),iparam1:e.readInt32(),iparam2:e.readInt32(),bparam1:e.readInt32(),bparam2:e.readInt32()},!0},function(e,t){return t.anim=e.readInt32(),t.body=e.readInt32(),!0},function(e,t){t.channel=e.readInt32();var r=e.readInt32();return t.samples=e.readUint8Array(r),t.attenuation=e.readFloat32(),t.volume=e.readFloat32(),t.flags=e.readInt32(),t.pitch=e.readInt32(),!0},function(e,t){var r=e.readInt32();return t.buffer=e.readUint8Array(r),!0}],y=function(){function e(){n(this,e),this.header={},this.directoryEntries=[],this.demoSize=0}return d(e,[{key:"onready",value:function(e){this.onready=e}},{key:"onerror",value:function(e){this.onerror=e}},{key:"parseBuffer",value:function(e){var t=new m.default(e);this.header=i(t),this.directoryEntries=f(t,this.header.directoryOffset),l(t,this.header,this.directoryEntries)}},{key:"parse",value:function(e){var t=new FileReader,r=this;this.header={},this.directoryEntries={},t.onload=function(){try{r.demoSize=t.result.byteLength,r.parseBuffer(t.result)}catch(e){return void(r.onerror&&r.onerror(e))}r.onready&&r.onready()},t.onerror=function(){r.onerror(new c("failed to read file"))},t.readAsArrayBuffer(e)}}]),e}();t.default=y},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t){r(this,e),this.view=new DataView(t),this.offset=0}return a(e,[{key:"readInt8",value:function(){var e=this.view.getInt8(this.offset,!0);return this.offset+=1,e}},{key:"writeInt8",value:function(e){this.view.setInt8(this.offset,e),this.offset+=1}},{key:"readUint8",value:function(){var e=this.view.getUint8(this.offset,!0);return this.offset+=1,e}},{key:"writeUint8",value:function(e){this.view.setUint8(this.offset,e),this.offset+=1}},{key:"readInt16",value:function(){var e=this.view.getInt16(this.offset,!0);return this.offset+=2,e}},{key:"writeInt16",value:function(e){this.view.setInt16(this.offset,e,!0),this.offset+=2}},{key:"readUint16",value:function(){var e=this.view.getUint16(this.offset,!0);return this.offset+=2,e}},{key:"writeUint16",value:function(e){this.view.setUint16(this.offset,e,!0),this.offset+=2}},{key:"readInt32",value:function(){var e=this.view.getInt32(this.offset,!0);return this.offset+=4,e}},{key:"writeInt32",value:function(e){this.view.setInt32(this.offset,e,!0),this.offset+=4}},{key:"readUint32",value:function(){var e=this.view.getUint32(this.offset,!0);return this.offset+=4,e}},{key:"writeUint32",value:function(e){this.view.setUint32(this.offset,e,!0),this.offset+=4}},{key:"readFloat32",value:function(){var e=this.view.getFloat32(this.offset,!0);return this.offset+=4,e}},{key:"writeFloat32",value:function(e){this.view.setFloat32(this.offset,e,!0),this.offset+=4}},{key:"readUint8Array",value:function(e){var t=new Uint8Array(this.view.buffer,this.offset,e);return this.offset+=e,t}},{key:"writeUint8Array",value:function(e){for(var t=0;t<e.length;++t)this.writeUint8(e[t])}},{key:"readString",value:function(e){for(var t=this.readUint8Array(e),r="",a=0;a<t.length&&t[a];++a)r+=String.fromCharCode(t[a]);return r}},{key:"writeString",value:function(e,t){for(var r=0;r<e.length;++r)this.writeUint8(e.charCodeAt(r));for(var a=0;a<t-e.length;++a)this.writeUint8(0)}},{key:"readFloat32Array",value:function(e){for(var t=[],r=0;r<e;++r)t.push(this.readFloat32());return t}},{key:"writeFloat32Array",value:function(e){for(var t=0;t<e.length;++t)this.writeFloat32(e[t])}},{key:"readInt32Array",value:function(e){for(var t=[],r=0;r<e;++r)t.push(this.readInt32());return t}},{key:"writeInt32Array",value:function(e){for(var t=0;t<e.length;++t)this.writeInt32(e[t])}},{key:"skip",value:function(e){this.offset+=e}},{key:"seekBeg",value:function(e){this.offset=e}}]),e}();t.default=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={HEADER_MAPNAME_SIZE:260,HEADER_GAMEDIRECTORY_SIZE:260,DIRECTORY_ENTRY_COUNT_MIN:1,DIRECTORY_ENTRY_COUNT_MAX:1024,DIRECTORY_ENTRY_DESCRIPTION_SIZE:64,FRAME_CONSOLE_COMMAND_SIZE:64,FRAME_SKYNAME_SIZE:32,FRAME_SIZE_MIN:12,FRAME_TYPE_MIN:2,FRAME_TYPE_MAX:9,FRAME_TYPE_DEMO_START:2,FRAME_TYPE_CONSOLE_COMMAND:3,FRAME_TYPE_CLIENT_DATA:4,FRAME_TYPE_NEXT_SECTION:5,FRAME_TYPE_EVENT:6,FRAME_TYPE_WEAPON_ANIM:7,FRAME_TYPE_SOUND:8,FRAME_TYPE_DEMO_BUFFER:9};t.default=r},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){e.writeFloat32(t.demoInfo.timestamp),e.writeFloat32Array(t.demoInfo.refParams.vieworg),e.writeFloat32Array(t.demoInfo.refParams.viewangles),e.writeFloat32Array(t.demoInfo.refParams.forward),e.writeFloat32Array(t.demoInfo.refParams.right),e.writeFloat32Array(t.demoInfo.refParams.up),e.writeFloat32(t.demoInfo.refParams.frametime),e.writeFloat32(t.demoInfo.refParams.time),e.writeInt32(t.demoInfo.refParams.intermission),e.writeInt32(t.demoInfo.refParams.paused),e.writeInt32(t.demoInfo.refParams.spectator),e.writeInt32(t.demoInfo.refParams.onground),e.writeInt32(t.demoInfo.refParams.waterlevel),e.writeFloat32Array(t.demoInfo.refParams.simvel),e.writeFloat32Array(t.demoInfo.refParams.simorg),e.writeFloat32Array(t.demoInfo.refParams.viewheight),e.writeFloat32(t.demoInfo.refParams.idealpitch),e.writeFloat32Array(t.demoInfo.refParams.cl_viewangles),e.writeInt32(t.demoInfo.refParams.health),e.writeFloat32Array(t.demoInfo.refParams.crosshairangle),e.writeFloat32(t.demoInfo.refParams.viewsize),e.writeFloat32Array(t.demoInfo.refParams.punchangle),e.writeInt32(t.demoInfo.refParams.maxclients),e.writeInt32(t.demoInfo.refParams.viewentity),e.writeInt32(t.demoInfo.refParams.playernum),e.writeInt32(t.demoInfo.refParams.max_entities),e.writeInt32(t.demoInfo.refParams.demoplayback),e.writeInt32(t.demoInfo.refParams.hardware),e.writeInt32(t.demoInfo.refParams.smoothing),e.writeInt32(t.demoInfo.refParams.ptr_cmd),e.writeInt32(t.demoInfo.refParams.ptr_movelets),e.writeInt32Array(t.demoInfo.refParams.viewport),e.writeInt32(t.demoInfo.refParams.nextView),e.writeInt32(t.demoInfo.refParams.onlyClientDraw),e.writeInt16(t.demoInfo.userCmd.lerp_msec),e.writeUint8(t.demoInfo.userCmd.msec),e.writeInt8(t.demoInfo.userCmd.align_1),e.writeFloat32Array(t.demoInfo.userCmd.viewangles),e.writeFloat32(t.demoInfo.userCmd.forwardmove),e.writeFloat32(t.demoInfo.userCmd.sidemove),e.writeFloat32(t.demoInfo.userCmd.upmove),e.writeInt8(t.demoInfo.userCmd.lightlevel),e.writeInt8(t.demoInfo.userCmd.align_2),e.writeUint16(t.demoInfo.userCmd.buttons),e.writeInt8(t.demoInfo.userCmd.impulse),e.writeInt8(t.demoInfo.userCmd.weaponselect),e.writeInt8(t.demoInfo.userCmd.align_3),e.writeInt8(t.demoInfo.userCmd.align_4),e.writeInt32(t.demoInfo.userCmd.impact_index),e.writeFloat32Array(t.demoInfo.userCmd.impact_position),e.writeFloat32(t.demoInfo.moveVars.gravity),e.writeFloat32(t.demoInfo.moveVars.stopspeed),e.writeFloat32(t.demoInfo.moveVars.maxspeed),e.writeFloat32(t.demoInfo.moveVars.spectatormaxspeed),e.writeFloat32(t.demoInfo.moveVars.accelerate),e.writeFloat32(t.demoInfo.moveVars.airaccelerate),e.writeFloat32(t.demoInfo.moveVars.wateraccelerate),e.writeFloat32(t.demoInfo.moveVars.friction),e.writeFloat32(t.demoInfo.moveVars.edgefriction),e.writeFloat32(t.demoInfo.moveVars.waterfriction),e.writeFloat32(t.demoInfo.moveVars.entgravity),e.writeFloat32(t.demoInfo.moveVars.bounce),e.writeFloat32(t.demoInfo.moveVars.stepsize),e.writeFloat32(t.demoInfo.moveVars.maxvelocity),e.writeFloat32(t.demoInfo.moveVars.zmax),e.writeFloat32(t.demoInfo.moveVars.waveHeight),e.writeInt32(t.demoInfo.moveVars.footsteps),e.writeString(t.demoInfo.moveVars.skyName,d.default.FRAME_SKYNAME_SIZE),e.writeFloat32(t.demoInfo.moveVars.rollangle),e.writeFloat32(t.demoInfo.moveVars.rollspeed),e.writeFloat32(t.demoInfo.moveVars.skycolor_r),e.writeFloat32(t.demoInfo.moveVars.skycolor_g),e.writeFloat32(t.demoInfo.moveVars.skycolor_b),e.writeFloat32(t.demoInfo.moveVars.skyvec_x),e.writeFloat32(t.demoInfo.moveVars.skyvec_y),e.writeFloat32(t.demoInfo.moveVars.skyvec_z),e.writeFloat32Array(t.demoInfo.view),e.writeInt32(t.demoInfo.viewmodel),e.writeInt32(t.incoming_sequence),e.writeInt32(t.incoming_acknowledged),e.writeInt32(t.incoming_reliable_acknowledged),e.writeInt32(t.incoming_reliable_sequence),e.writeInt32(t.outgoing_sequence),e.writeInt32(t.reliable_sequence),e.writeInt32(t.last_reliable_sequence),e.writeInt32(t.msg.length),e.writeUint8Array(t.msg)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),f=r(2),s=a(f),l=r(3),d=a(l),u=[function(){},function(){},function(){},function(e,t){e.writeString(t.command,d.default.FRAME_CONSOLE_COMMAND_SIZE)},function(e,t){e.writeFloat32Array(t.origin),e.writeFloat32Array(t.viewangles),e.writeInt32(t.weaponBits),e.writeFloat32(t.fov)},function(){},function(e,t){e.writeInt32(t.flags),e.writeInt32(t.index),e.writeFloat32(t.delay),e.writeInt32(t.eventArgs.flags),e.writeInt32(t.eventArgs.entityIndex),e.writeFloat32Array(t.eventArgs.origin),e.writeFloat32Array(t.eventArgs.angles),e.writeFloat32Array(t.eventArgs.velocity),e.writeInt32(t.eventArgs.ducking),e.writeFloat32(t.eventArgs.fparam1),e.writeFloat32(t.eventArgs.fparam2),e.writeInt32(t.eventArgs.iparam1),e.writeInt32(t.eventArgs.iparam2),e.writeInt32(t.eventArgs.bparam1),e.writeInt32(t.eventArgs.bparam2)},function(e,t){e.writeInt32(t.anim),e.writeInt32(t.body)},function(e,t){e.writeInt32(t.channel),e.writeInt32(t.samples.length),e.writeUint8Array(t.samples),e.writeFloat32(t.attenuation),e.writeFloat32(t.volume),e.writeInt32(t.flags),e.writeInt32(t.pitch)},function(e,t){e.writeInt32(t.buffer.length),e.writeUint8Array(t.buffer)}],m=function(){function e(){n(this,e),this.fileUrl=null}return i(e,[{key:"getBlobUrl",value:function(e){null!==this.fileUrl&&URL.revokeObjectURL(this.fileUrl);var t=new Blob([e],{type:"application/octet-binary"});return this.fileUrl=URL.createObjectURL(t),this.fileUrl}},{key:"save",value:function(e,t,r){var a=new ArrayBuffer(e+d.default.FRAME_SIZE_MIN),n=new s.default(a);n.writeString("HLDEMO",8),n.writeInt32(t.demoProtocol),n.writeInt32(t.netProtocol),n.writeString(t.mapName,d.default.HEADER_MAPNAME_SIZE),n.writeString(t.gameDirectory,d.default.HEADER_GAMEDIRECTORY_SIZE),n.writeInt32(t.mapCRC);var i=n.offset;n.skip(4);for(var f=[],l=0;l<r.length;++l){var m=r[l];f.push(n.offset);for(var I=!1,w=0;w<m.frames.length;++w){var c=m.frames[w];n.writeUint8(c.type),n.writeFloat32(c.time),n.writeInt32(c.frame),d.default.FRAME_TYPE_MIN<=c.type&&c.type<=d.default.FRAME_TYPE_MAX?u[c.type](n,c):o(n,c),c.type===d.default.FRAME_TYPE_NEXT_SECTION&&(I=!0)}I||(n.writeUint8(d.default.FRAME_TYPE_NEXT_SECTION),n.writeFloat32(0),n.writeInt32(0))}var v=n.offset;n.writeInt32(r.length);for(var y=0;y<r.length;++y){var _=r[y];n.writeInt32(_.type),n.writeString(_.description,d.default.DIRECTORY_ENTRY_DESCRIPTION_SIZE),n.writeInt32(_.flags),n.writeInt32(_.CDtrack),n.writeFloat32(_.trackTime),n.writeInt32(_.frameCount),n.writeInt32(f[y]),n.writeInt32(_.fileLength)}return n.seekBeg(i),n.writeInt32(v),this.getBlobUrl(a)}}]),e}();t.default=m}]);